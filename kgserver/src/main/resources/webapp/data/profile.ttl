#
# SWS profile: a construct query and a HTML transformation
# st:param specify parameters passed to transformation 
# accessible using st:get(st:lang)
#

prefix p:    <http://fr.dbpedia.org/property/>
prefix o:    <http://dbpedia.org/ontology/>

st:dbturtle a st:Profile ;
  st:query  <query/frdbpedia.rq> ;
  st:transform  st:turtle .
  
st:dbhturtle a st:Profile ;
  st:query  <query/frdbpedia.rq> ;
  st:transform  st:hturtle .  

st:dbsparql a st:Profile ;
  st:query  <query/frdbpedia.rq> ;
  st:param [
     st:lodprofile (( <http://fr.dbpedia.org/resource/> st:dbpedia))
  ] ;
  st:transform st:sparql .
 # st:transform  "/user/corby/home/AAData/sttl/sparql" . 

 
 
st:dbpedia a st:Profile ;   
  st:param [ 
    st:lang "fr" ;
    st:import st:dbpediaParam, st:mapParam  ;    
  ] ;
  st:workflow [
      sw:body ( 
	<query/frdbpedia.rq> <query/frdbpediaclean.rq> 
	[ a sw:Template ; sw:uri st:navlab ]
      )
  ] .
 # st:transform  st:navlab .
  
st:test a st:Profile ;
  st:workflow [
    sw:debug true ;
    sw:body (
      [ a sw:Query ; sw:result sw:graph  ;
	sw:body "select * where {?x ?p ?y} limit 100" ]
      [ a sw:Template ; sw:uri st:sparql ]
    )
  ]
.
  
st:loop a st:Profile ;
  st:workflow [
    sw:debug true ;
    sw:loop 3 ;
    sw:body (
      [ a sw:Query ; sw:body "select * where {?x ?p ?y} limit 100" ]
      [ a sw:Template ; sw:uri st:sparql ]
    )
  ]

st:dbpedialoop a st:Profile ;   
  st:param [ 
    st:lang "fr" ;
    st:import st:dbpediaParam, st:mapParam  ;
    st:file "/user/corby/home/test.ttl" ;    
  ] ;
  st:workflow [ 
      sw:loop 5 ;
      sw:body ( 
      <query/frdbpediastart.rq> 
      <query/frdbpediacopy.rq> <query/frdbpediaclean.rq> <query/frdbpedialoop.rq> <query/save.rq> )] ;
  st:transform  st:navlab .
  
  
st:owl a st:Profile ;
  st:workflow [
    sw:debug true ;
    sw:param [ sw:debug true ] ;
    sw:body ( 
    [ a sw:Query ; sw:uri <query/frdbpediaclean.rq> ] 
    [ a sw:Rule ; sw:uri sw:owlrl ] 
    [ a sw:Template ; sw:uri st:turtle ]
    )
] ;
st:transform st:sparql .


st:owlsave a st:Profile ;
  st:workflow [ st:body ( 
  [ a sw:Query ; sw:uri <query/frdbpediaclean.rq> ] 
  [ a sw:Rule ; sw:uri sw:owlrl ] 
  [ a sw:Template ; sw:uri st:turtle ]
  )
] ;
st:transform st:sparql .


st:dbpediadyn a st:Profile ;   
  st:param [ 
    st:lang "fr" ;
    st:import st:dbpediaParam, st:mapParam  ;
  ] ;
  st:query     "/user/corby/home/AAServer/data/query/frdbpedia.rq" ;
  st:transform "/user/corby/home/AAData/sttl/navlab" .  
  
  
  
st:dbedit a st:Profile ;
  st:param [
    st:uri <http://ns.inria.fr/sparql-template/date/09/2015> ;
    # include &mode=st:get(st:mode) to hypertext link to server
    # st:include (st:mode)
  ] ;
  st:transform st:dbedit .
  
st:dbeditdyn a st:Profile ;
  st:param [
    st:uri <http://ns.inria.fr/sparql-template/date/10/2015> 
  ] ;
  st:transform "/user/corby/home/AAData/sttl/dbedit" .
  
st:dbedityear a st:Profile ;
  st:param [
    st:uri <http://ns.inria.fr/sparql-template/date/2015>
  ] ;
  st:transform "/user/corby/home/AAData/sttl/dbedit#year" .
  
st:mapParam
    st:param [ 
        st:mapzoom 6 ;
        st:mapsize "mapmedium" ;
        st:mapicon1 "/img/bmarker.png" ;
        st:mapicon2 "/img/smarker.png" 
      ]  .
  
st:dbpediaParam 
  st:param [
  
  st:person (
          (p:dateDeNaissance 	"Naissance" 	"Birth")
	  (p:dateDeDécès 	"Décès"		"Death")
	  (o:predecessor 	"Prédécesseur"	"Predecessor")
	  (o:successor          "Successeur"	"Successor")
	  (o:father 		"Père"		"Father")
	  (o:mother 		"Mère"		"Mother")
	  (o:spouse 		"Conjoints"	"Spouse")
	  (o:child 		"Enfants"	"Children")
	  (o:residence          "Résidence"	"Residence")
	  (rdfs:comment 	"Résumé"	"Abstract")
	  (o:wikiPageRedirects  "Voir aussi"	"See Also")
	  (o:wikipedia          "Wikipedia"	"Wikipedia")
	  (o:dbpedia		"DBpedia"	"DBpedia"))
  ] .
  
st:dbpediaen a st:Profile ;
  st:query  <query/frdbpediaen.rq> ;
  st:transform  st:navlab ;
  st:param [
    st:lang "en" ;
  ] .
  
st:calendar a st:Profile ;
  #st:transform "/user/corby/home/AAData/sttl/calendar"; 
  st:transform st:calendar ;
  st:param [
    st:debug true ;
  ] .
  
  
st:calendartest a st:Profile ;
  st:transform <http://ns.inria.fr/sparql-template/calendar#test> ;
  st:param [
    st:debug true ;
    st:list (("OC" 1959) ("FC" 1964)) ;
  ] .
  
  
st:calendar1 a st:Profile ;
  st:query     <query/dbpediadate.rq> ;  
  st:transform st:content ;
   st:param [
    st:uri   st:y2000 ;
    st:title "Born calendar";
  ] .

st:calendar2 a st:Profile ;
  st:query     <query/dbpediadate2.rq> ;
  st:transform st:content ;
  st:param [
    st:uri    st:y2000 ;
    st:title "Decease calendar";
  ] .
  
st:calendar3 a st:Profile ;
  st:query     <query/dbpediadate3.rq> ;
  #st:transform "/user/corby/home/AAData/sttl/calcontent"; 
  st:transform st:content ;  
  st:param [
    st:uri    st:y1944 ;
    st:title "Event calendar";
  ] .

@prefix ct: <http://ns.inria.fr/sparql-template/content#>

# calendar to query dbpedia for event given month-day for any year
# show answer of such query
st:gcalendar a st:Profile ;
  st:query     <query/dbpediadatemd.rq> ;
  st:transform ct:query ;  
  st:param [
    st:import st:cal ;
    st:title "Born calendar";
  ] .
  
# additional shared param
st:cal 
  st:param [
    st:uri    st:d2000-02-29 ;
].
  
  
st:gcalendar2 a st:Profile ;
  st:query     <query/dbpediadatemd2.rq> ;
  st:transform ct:query ;  
  st:param [
    st:import st:cal ;
    st:title "Decease calendar";
  ] .
  
st:gcalendar3 a st:Profile ;
  st:query  <query/dbpediadatemd3.rq> ;
  st:transform ct:query ; 
   st:param [
    st:import st:cal ;
    st:title "Born & Decease calendar";
  ] .
  
  
st:calendar4 a st:Profile ;
  st:query     <file:///home/corby/ADataServer/query/dbpediadate4.rq> ;
  st:transform "/home/corby/AData/sttl/content" .
   

st:dbpediasparql a st:Profile ;
  st:query     <query/frdbpedia.rq> ;
  st:transform st:sparql .


st:dbpediacopy a st:Profile ;
  st:query     <query/frdbpediacopy.rq> ;
  st:transform st:navlab .
  
@prefix r: <http://fr.dbpedia.org/resource/>

st:dbpediains a st:Profile ;
  st:query     <query/frdbpediains.rq> ;
  st:transform st:navlab ;
  st:param [
  # where to save graph resulting from query
    st:file "/home/corby/dbpedia.ttl";
    st:list (
 # r:Gibraltar r:Ceuta r:Melilla r:Enclave_des_papes
   r:Andorre r:Monaco  r:Kaliningrad r:Liechtenstein
    r:Llívia r:Saint-Marin r:Vatican     r:Büsingen_am_Hochrhein r:Jungholz r:Baerle-Duc
    r:Sastavci r:Brezovica_Žumberačka r:Akrotiri_et_Dhekelia <http://fr.dbpedia.org/resource/Campione_d'Italia>
    <http://fr.dbpedia.org/resource/San'kovo-Medvezh'e>
    r:Vennbahn    
    )
  ] .
  

st:dbpediaall a st:Profile ;
  st:query     <query/frdbpediaall.rq> ;
  st:variable  "?r" ;
  st:transform st:navlab .

st:navlab a st:Profile ;
  st:workflow [ 
    sw:body ( [ a sw:Template ; sw:uri st:navlab ] ) 
  ] .
#  st:transform st:navlab .  

st:web a st:Profile ;
   st:transform st:web .

st:weben a st:Profile ;
   st:param [ st:lang 'en' ];
   st:transform st:web .

   # LDP on local dataset
st:sparql a st:Profile ;
    st:query <query/construct.rq> ;
    st:variable "?r" ;
    st:transform st:sparql .
    #st:transform "/user/corby/home/AAData/sttl/sparql" .

    # LDP on target URI
st:std a st:Profile ;
    st:query <query/construct.rq> ;
    st:variable "?r" ;
    st:transform st:sparql .

st:rdfs a st:Profile ;
    st:transform st:rdfs .
    
st:local a st:Profile ;
  st:query     <query/local.rq> ;
  st:transform st:navlab .

st:personen a st:Profile ;
  st:query     <query/dbpedia.rq> ;
  st:transform st:navlab .  

st:bound a st:Profile ;
st:query <query/bound.rq>;
st:transform st:navlab .  
 
st:mglt a st:Profile ;
st:query <query/mglt.rq>;
st:transform st:navlab . 

st:spqr a st:Profile ;
st:query <query/spqr.rq>;
st:transform st:navlab . 
       

###################################


   
  
st:owlrltest a st:Server ;
  st:service "test" ;
  st:data [ st:uri <primer.owl>  ; st:name st:data ] ;
  st:workflow [ sw:body ( <query/owlrltest.rq> ) ] ;
  st:transform st:hturtle
 .

st:ldp a st:Server ;
st:service "ldp" ;
 st:data [ st:uri <tutorial/human1.rdf>  ; st:name st:data ] ;
 st:param [
    st:lodprofile (
    ( <http://fr.dbpedia.org/resource>  st:dbsparql )
    ( <http://www.inria.fr/2015/humans> st:sparql )
    ( "*" st:sparql )
    );
 ] .
 

st:default1 a st:Server ;
st:data     
    [ st:uri <dbpedia/rome.ttl>  ; st:name st:data ] . 
 
 
st:default a st:Server ;
st:data     
    [ st:uri <tutorial/human1.rdf>  ; st:name st:data1 ] ,
    [ st:uri <tutorial/human2.rdf>  ; st:name st:data2 ] ,
    [ st:uri <tutorial/pragma.ttl>  ; st:name st:pragma ] .
    
    


# Dataset of specific services, e.g. /tutorial/rdf

#@base <file:///user/corby/home/ADataServer/>

st:tutorial1 a st:Server ;
  st:service "rdf" ;
  st:transform st:web ;
  #st:transform "/user/corby/home/AAData/sttl/web";
  st:data     
    [ st:uri <tutorial/human1.rdf>  ; st:name st:data1 ] ,
    [ st:uri <tutorial/human2.rdf>  ; st:name st:data2 ] ,
    [ st:uri <tutorial/pragma.ttl>  ; st:name st:pragma ] ;
  st:context  [ st:uri <tutorial/tutorial.ttl>  ; st:name st:context ] .

st:tutorial2 a st:Server ;
  st:service "rdfs" ;
  st:transform st:web ;
  st:param [ st:lang "en" ] ;
  st:data     
    [ st:uri <tutorial/human1.rdf>  ; st:name st:data1 ] ,
    [ st:uri <tutorial/human2.rdf>  ; st:name st:data2 ] ,
    [ st:uri <tutorial/pragma.ttl>  ; st:name st:pragma ] ;
  st:schema   [ st:uri <tutorial/human.rdfs> ; st:name st:schema ] ;
  st:context  [ st:uri <tutorial/tutorial.ttl>  ; st:name st:context ] .

st:rome a st:Server ;   
  st:service "rome" ;
  st:param [ 
    st:lang "fr" ;
    st:import st:dbpediaParam, st:mapParam  ;   
  ] ;
  st:data [st:uri <dbpedia/rome.ttl> ; st:name st:data ] ;
  st:transform  st:navlab .   
  
st:geo a st:Server ;
  st:service "geo" ;
  st:transform st:navlab ; 
  #"/user/corby/home/AAData/sttl/navlab" ;
  st:param [ 
    st:lang "en"   ;
    st:mapzoom 5 ;
    st:mapsize "maplarge" ;
    st:import  st:mapParam  ;
  ] ;
  st:data     
    [ st:uri <dbpedia/dbpedia.ttl>  ; st:name st:geo ] .
    

st:save a st:Profile ;
  st:query <query/save.rq> ;
  st:transform st:sparql ;
  st:param [
    st:file "/home/corby/dbpedia.ttl";
  ] .

  
@prefix cn: <http://cdn.fr/schema/>
  
# /tutorial/cdn
st:cdn a st:Server ;
    st:service "cdn" ;
    #st:transform "/user/corby/home/AAData/sttl/cdn"; 
    st:transform st:cdn ;
    
    st:param [
      st:import st:history
    ] ;
    
    st:data 
    [ st:uri <cdn/aa_siecle.ttl> ], [ st:uri <cdn/fr.ttl> ], 
    [ st:uri <cdn/spqr.ttl> ], 
    [ st:uri <cdn/franc.ttl> ],
    [ st:uri <cdn/eds.ttl> ], 
    [ st:uri <cdn/emp.ttl> ],    [ st:uri <cdn/provence.ttl> ], [ st:uri <cdn/icon.rdf> ], 
    [ st:uri <cdn/icon.ttl> ],   [ st:uri <cdn/context.ttl> ],  
    [ st:uri <cdn/an1000.ttl> ], [ st:uri <cdn/an1100.ttl> ], 
    [ st:uri <cdn/an1200.ttl> ], [ st:uri <cdn/an1300.ttl> ], [ st:uri  <cdn/an1400.ttl> ], 
    [ st:uri <cdn/an1500.ttl> ], [ st:uri <cdn/an1600.ttl> ], [ st:uri <cdn/an1700.ttl> ], 
    [ st:uri <cdn/an1800.ttl> ], [ st:uri <cdn/an1900.ttl> ], [ st:uri <cdn/pos.ttl> ].
    
    
 st:history a st:Profile ;
    st:transform st:cdn ;        
    st:param [
      st:text ( "Antiquité" "France" "Contexte" "Savoie, Piémont" "Comté de Nice");
      st:topic ( (cn:rome) (cn:fr) (cn:emp cn:context) (cn:mds) (cn:cdn)) ;      
   #   st:uri cn:XVIII ;
      st:min -700 ;
      st:max 3000 ;
    ] .
    
    
 st:antiquity a st:Profile ;
    st:transform st:cdn ;    
    st:param [      
      st:text ( "Antiquité"  "France" "Contexte" );
      st:topic ( (cn:rome) (cn:fr) (cn:emp cn:context) ) ;      
      st:uri cn:I ;
      st:min -700 ;
      st:max 500 ;
    ] .
          

st:owlrl a st:Server ;
    st:service "owlrl" ;
    st:transform st:hturtle ;
    st:schema 
    [ st:uri <primer.owl> ] 
.


#st:loadLocal a st:Profile ; st:load <paca/mglt.ttl>, <paca/spqr.ttl>, <paca/borne.ttl>, <paca/cdn.ttl> .