sudo: required

services:
  - docker
  
  notifications:
  email:
    recipients:
      - Ahmedkounasso@gmail.com
    on_success: always # default: change (other : never)
    on_failure: never # default: always
   
script:
 
  - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
  - export REPO=Ahmedko/corese.git
  - export TAG=`if [ "$TRAVIS_BRANCH" == "master" ]; then echo "latest"; else echo $TRAVIS_BRANCH ; fi`
  - docker build -t corese .
  - git clone --recursive https://github.com/Ahmedko/corese.git
  - cd corese/
  - docker tag $REPO:$COMMIT $REPO:$TAG
  - docker tag $REPO:$COMMIT $REPO:travis-$TRAVIS_BUILD_NUMBER
  - docker push $REPO
  - docker run -p 49160:8080 -d corese
